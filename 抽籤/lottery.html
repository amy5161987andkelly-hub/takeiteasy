<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ’– å åœä¸æ±‚äºº</title>
    
    <link rel="stylesheet" href="../styles.css"> 

    <style>
        /* --- åŸºç¤æ¨£å¼èˆ‡èƒŒæ™¯ --- */
        body {
            font-family: 'å¾®è»Ÿæ­£é»‘é«”', 'Arial', sans-serif;
            text-align: center;
            padding: 30px;
            background-color: #ffeef2; /* æ·ºç²‰è‰²å¯æ„›èƒŒæ™¯ */
            color: #4a4a4a;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding-top: 60px; /* ğŸ’¥ ç‚ºè¿”å›éµé ç•™é ‚éƒ¨ç©ºé–“ ğŸ’¥ */
            position: relative;
        }

        /* ğŸ’¥ æ–°å¢ï¼šè¿”å›éµæ¨£å¼å®šä½ ğŸ’¥ */
        .back-button {
            position: fixed; /* å›ºå®šåœ¨é é¢ä¸Šæ–¹ */
            top: 15px;
            left: 15px;
            text-decoration: none;
            color: #d6336c; 
            background: rgba(255, 255, 255, 0.8);
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: bold;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            z-index: 1000; /* ç¢ºä¿åœ¨å…¶ä»–å…§å®¹ä¹‹ä¸Š */
            transition: background 0.2s;
        }
        .back-button:hover {
            background: rgba(255, 255, 255, 1);
        }

        /* --- æ¨™é¡Œå®¹å™¨ï¼šå‚ç›´ç½®ä¸­ä¸”é–“è·ç·Šå¯† --- */
        #mainHeader {
            margin-bottom: 40px; 
            padding-top: 5px; 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
        }

        h1 {
            color: #d6336c; /* æ·±ç²‰è‰²æ¨™é¡Œ */
            font-size: 2.5em;
            margin-bottom: 0; 
            margin-top: 0; 
            line-height: 1.2;
            text-align: center;
        }
        
        .subtitle {
            font-size: 1.2em;
            color: #888;
            margin-top: 5px; 
            margin-bottom: 0;
            text-align: center;
        }

        /* --- æŒ‰éˆ•è¨­è¨ˆ (è·³å‹•çš„å¿ƒè‡Ÿ) --- */
        #drawButton {
            position: relative;
            padding: 20px 40px;
            font-size: 1.5em;
            cursor: pointer;
            background-color: #ff69b4; 
            color: white;
            border: none;
            border-radius: 50px; 
            box-shadow: 0 8px 15px rgba(214, 51, 108, 0.4);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            overflow: hidden; 
        }
        #drawButton:hover {
            background-color: #ff85c0;
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(214, 51, 108, 0.6);
        }
        #drawButton:disabled {
            cursor: not-allowed;
            opacity: 0.7;
        }

        /* å¿ƒè‡Ÿåœ–æ¨™å’Œæ–‡å­—å®¹å™¨ */
        .heart-container {
            display: flex;
            align-items: center;
            animation: pulse 1s infinite alternate; 
        }
        .heart-icon {
            font-size: 2em;
            line-height: 1;
            margin-right: 10px;
        }

        /* --- å¿ƒè·³å‹•ç•« --- */
        @keyframes pulse {
            0% { transform: scale(1); }
            100% { transform: scale(1.05); }
        }

        /* --- ç±¤è©©çµæœå€å¡Š --- */
        #lotteryResult {
            margin: 30px auto;
            max-width: 650px;
            width: 100%;
            background-color: white;
            border: 3px solid #ff69b4;
            border-radius: 15px;
            padding: 20px;
            min-height: 150px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            position: relative;
            opacity: 1;
            transition: opacity 0.5s ease;
        }
        #lotteryResult.hidden {
            opacity: 0;
            pointer-events: none;
        }
        #lotteryResult h2 {
            color: #d6336c;
            border-bottom: 2px solid #ff69b4;
            padding-bottom: 10px;
            text-align: center;
        }

        /* ğŸ’¥ æ–°å¢ï¼šçµæœåœ–ç‰‡çš„å°ˆç”¨æ¨£å¼ ğŸ’¥ */
        .poem-image {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 20px auto;
            border: 1px solid #ddd;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1); /* è¼•å¾®é™°å½± */
        }

        /* --- ç…™éœ§/éæ¸¡æ•ˆæœå€å¡Š --- */
        #smokeOverlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.95); 
            display: none; 
            flex-direction: column;
            justify-content: center;
            align-items: center;
            font-size: 2.5em;
            color: #d6336c;
            z-index: 1000;
        }
        .smoke-text {
            animation: flicker 0.8s infinite alternate;
        }

        /* ç…™éœ§å‹•ç•« */
        @keyframes flicker {
            0% { opacity: 0.8; }
            100% { opacity: 1; }
        }
    </style>
</head>
<body>
    
    <a href="../index.html" class="back-button">
        â¬…ï¸ è¿”å›ç®¡ç†å±€é¦–é 
    </a>

    <div id="smokeOverlay">
        <div class="smoke-text">âœ¨ å‘½é‹æ­£åœ¨é¡¯ç¾... âœ¨</div>
    </div>

    <div id="mainHeader">
        <h1>ğŸ”® å åœä¸æ±‚äºº</h1>
        <div class="subtitle">ä¿¡ä¸ä¿¡ç”±ä½ ï¼èª å¿ƒé»æ“Šå¿ƒè‡Ÿï¼ŒæŠ½å–ä»Šæ—¥æŒ‡å¼•ã€‚</div>
    </div>

    <button id="drawButton" onclick="startDrawProcess()">
        </button>

    <div id="lotteryResult">
        <p style="text-align: center;">æŠ½ç±¤çµæœå°‡æœƒé¡¯ç¤ºåœ¨é€™è£¡...</p>
    </div>

    <script>
        // *** ç±¤è©©æ•¸é‡å·²è¨­å®šç‚º 100 ***
        const totalPoems = 100; 
        // è¨­å®šç±¤è©©æª”æ¡ˆæ‰€åœ¨çš„è³‡æ–™å¤¾åç¨±
        const poemsFolder = ''; 
        const resultElement = document.getElementById('lotteryResult');
        const drawButton = document.getElementById('drawButton');
        const smokeOverlay = document.getElementById('smokeOverlay');
        
        // æŒ‰éˆ•å…§å®¹çš„ HTML
        const buttonContent = '<div class="heart-container"><span class="heart-icon">â¤ï¸</span>AS YOU WISH</div>';

        /**
         * å•Ÿå‹•æŠ½ç±¤æµç¨‹ (åŒ…å«ç…™éœ§éæ¸¡å‹•ç•«)
         */
        function startDrawProcess() {
            // 1. é–å®šæŒ‰éˆ•ä¸¦éš±è—çµæœ
            drawButton.disabled = true;
            resultElement.classList.add('hidden');
            
            // 2. é¡¯ç¤ºç…™éœ§éæ¸¡å±¤
            smokeOverlay.style.display = 'flex';

            // 3. å»¶æ™‚ 1.5 ç§’åŸ·è¡ŒæŠ½ç±¤å’Œé¡¯ç¤ºçµæœ
            setTimeout(() => {
                drawLottery();
                
                // 4. éš±è—ç…™éœ§å±¤ä¸¦é¡¯ç¤ºçµæœ
                smokeOverlay.style.display = 'none';
                resultElement.classList.remove('hidden');

                // è®“ç•«é¢è‡ªå‹•å¹³æ»‘æ»¾å‹•åˆ°çµæœå€å¡Šä¸­å¤®
                resultElement.scrollIntoView({ 
                    behavior: 'smooth', 
                    block: 'center'    
                });

                // æŒ‰éˆ•é‡æ–°å•Ÿç”¨å·²åŒ…å«åœ¨ drawLottery å‡½å¼å…§ (åœ–ç‰‡çš„ onload/onerror)
            }, 1500); 
        }

        /**
         * æ ¸å¿ƒæŠ½ç±¤å‡½å¼ï¼šéš¨æ©Ÿé¸æ“‡ç±¤è™Ÿä¸¦è¼‰å…¥å°æ‡‰çš„ JPG åœ–ç‰‡
         */
        function drawLottery() {
            // 1. ç”Ÿæˆä¸€å€‹ 1 åˆ° 100 ä¹‹é–“çš„éš¨æ©Ÿç±¤è™Ÿ
            const randomPoemNumber = Math.floor(Math.random() * totalPoems) + 1;

            // 2. æ§‹å»ºæª”æ¡ˆè·¯å¾‘ (å‰¯æª”åç‚º .jpg)
            const filePath = `${poemsFolder}${randomPoemNumber}.jpg`;

            // 3. ä½¿ç”¨ <img> æ¨™ç±¤ä¾†é¡¯ç¤ºåœ–ç‰‡
            resultElement.innerHTML = `
                <h2>ğŸ”” æŠ½ä¸­ç±¤è™Ÿ: ç¬¬ ${randomPoemNumber} ç±¤</h2>
                <hr>
                <img 
                    src="${filePath}" 
                    alt="æŠ½åˆ°çš„ç±¤è©©åœ–ç‰‡" 
                    class="poem-image" onload="document.getElementById('drawButton').disabled = false; document.getElementById('drawButton').innerHTML = buttonContent;"
                    onerror="handleImageError('${filePath}');"
                >
            `;
            
            // åœ–ç‰‡è¼‰å…¥å¤±æ•—çš„è™•ç†ç¨‹åºä¸éœ€è¦æ”¾åœ¨ onload/onerror å±¬æ€§ä¸­ï¼Œä½†ç‚ºäº†ä¿ç•™æ‚¨çš„åŸå§‹çµæ§‹ï¼Œä¿æŒä¸è®Šã€‚
        }

        /**
         * è™•ç†åœ–ç‰‡è¼‰å…¥å¤±æ•—çš„éŒ¯èª¤è¨Šæ¯
         */
        function handleImageError(filePath) {
            document.getElementById('lotteryResult').innerHTML = `
                <h3 style="color: #FF0000; text-align: center;">âŒ è¼‰å…¥åœ–ç‰‡å¤±æ•—ï¼(404 Not Found)</h3>
                <p style="text-align: center;">è«‹æª¢æŸ¥æª”æ¡ˆè·¯å¾‘æ˜¯å¦æ­£ç¢ºï¼š<code>${filePath}</code></p>
                <p style="text-align: center;">è«‹ç¢ºèªæ‚¨æ˜¯å¦æœ‰ <code>1.jpg</code> åˆ° <code>${totalPoems}.jpg</code> å…± ${totalPoems} å€‹æª”æ¡ˆã€‚</p>
            `; 
            document.getElementById('drawButton').disabled = false; 
            document.getElementById('drawButton').innerHTML = buttonContent;
        }

        // åˆå§‹åŒ–ï¼šè¨­å®šæŒ‰éˆ•å…§å®¹
        drawButton.innerHTML = buttonContent; 
        
    </script>
</body>
</html>